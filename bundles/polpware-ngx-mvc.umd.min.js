!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@polpware/fe-data"),require("@polpware/fe-dependencies"),require("@polpware/fe-utilities"),require("@polpware/fe-mvc"),require("@angular/core")):"function"==typeof define&&define.amd?define("@polpware/ngx-mvc",["exports","@polpware/fe-data","@polpware/fe-dependencies","@polpware/fe-utilities","@polpware/fe-mvc","@angular/core"],t):t((e.polpware=e.polpware||{},e.polpware["ngx-mvc"]={}),e.feData,e.hInterface,e.feUtilities,e.feMvc,e.ng.core)}(this,function(e,n,t,o,i,r){"use strict";var a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)};function s(e,t){function o(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}var c=function(){return(c=Object.assign||function(e){for(var t,o=1,r=arguments.length;o<r;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};function p(e,t){var o="function"==typeof Symbol&&e[Symbol.iterator];if(!o)return e;var r,n,i=o.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(r=i.next()).done;)a.push(r.value)}catch(s){n={error:s}}finally{try{r&&!r.done&&(o=i["return"])&&o.call(i)}finally{if(n)throw n.error}}return a}function d(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(p(arguments[t]));return e}var u=function(){function e(){this.moreDataCanBeLoaded=!1,this.callbacks={onRefresh:null,onInfinite:null}}return e.prototype.turnOnMediator=function(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];var r=this.buildViewInstance();this.listMediator.startService(r,e)},e.prototype.turnOffMediator=function(){this.listMediator.stopService()},e}(),f=t.underscore,l=f.noop;function h(o){return{$data:{init:function(){o.$scope.moreDataCanBeLoaded=!1},setRefreshCallback:function(e){o.$scope.callbacks.onRefresh=e},setInfiniteCallback:function(e){o.$scope.callbacks.onInfinite=e},clean:function(){o.$scope.onItemsReady()},asyncPush:function(e){o.$scope.onNewItemsReady(e),o.$scope.onItemsReady()},syncPush:function(e){o.$scope.onNewItemsReady(e),o.$scope.onItemsReady()},asyncPop:function(e){o.$scope.onItemsReady()},syncPop:function(e){o.$scope.onItemsReady()},asyncPrepend:function(e){o.$scope.onNewItemsReady(e),o.$scope.onItemsReady()},syncPrepend:function(e){o.$scope.onNewItemsReady(e),o.$scope.onItemsReady()},asyncRefresh:l,syncRefresh:l,hasMoreData:function(e){o.$scope.moreDataCanBeLoaded=e},getItems:function(){},setupSearch:function(e,t){o.$scope.searchCriteria=e,o.$scope.doSearch=t},updateSearchCriteria:function(e){o.$scope.searchCriteria=e},getAncestor:function(){return o.$scope.ancestor}},$loader:{show:function(){o.$scope.showLoadingIndicator()},hide:function(){o.$scope.hideLoadingIndicator()}},$refresher:{show:function(){o.$scope.showRefreshingIndicator()},hide:function(){o.$scope.hideRefreshingIndicator()}},$moreLoader:{show:function(){o.$scope.showMoreLoading()},hide:function(){o.$scope.hideMoreLoading()}},$router:{go:function(e,t){o.$state.go(e,t)}},$render:{ready:function(e){o.$scope.callbacks.onViewDidLoad=e},destroy:function(e){o.$scope.callbacks.onViewWillUnload=e},asyncDigest:l},$navBar:{getState:l,setState:l},$modal:{setData:function(e,t){o.$scope[e]=t},getData:function(e){return o.$scope[e]},build:l},$popover:{setData:function(e,t){o.$scope[e]=t},getData:function(e){return o.$scope[e]},build:l,onHidden:l},$popup:{setData:function(e){o.$scope.popupInput=f.extend({confirmed:!1},e)},getData:function(){return o.$scope.popupInput},build:l,confirm:l,prompt:l,alert:l},$progressBar:{create:l,reset:function(){o.$scope.progressBar=0},createInfinite:l,onProgress:function(e){o.$scope.progressBar=e},destroy:l,destroyInfinite:l,showAbort:l},$alertify:o.alertify,$history:{goBack:function(){o.$ionicHistory.goBack()}}}}var y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.prototype.onDocumentReady=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.ensureDataProvider.apply(this,d(e))},t.prototype.onDocumentDestroy=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.turnOffMediator(),this.afterMediatorOff()},t.prototype.onDataProviderReady=function(e){var t=this;this.buildMediator(e).then(function(){t.turnOnMediator(!1),t.afterMediatorOn()})},t.prototype.buildViewInstance=function(){return h({$scope:this})},t.prototype.doRefresh=function(){this.callbacks.onRefresh&&this.callbacks.onRefresh()},t.prototype.doInfinite=function(){this.callbacks.onInfinite&&this.callbacks.onInfinite()},t.prototype.showLoadingIndicator=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},t.prototype.hideLoadingIndicator=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},t.prototype.setLoadingIndicatorDelay=function(e){},t.prototype.showMoreLoading=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},t.prototype.hideMoreLoading=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},t.prototype.showRefreshingIndicator=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},t.prototype.hideRefreshingIndicator=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},t}(u),g=function(r){function e(){var e=r.call(this)||this;return e.defaultLivePeriod=300,e.mediatorCtorOptions={useModel:!0,enableInfinite:!0,enableRefresh:!0},e.items=[],e._onCacheExpireCallback=null,e}return s(e,r),e.prototype.turnOnMediator=function(e){var o=this;r.prototype.turnOnMediator.call(this,e);var t=this.asNgStoreListMeidator.getNgStore();this._storeSubscription=t.getState().subscribe(function(e){var t=e.items;o.items=t,o.onItemsReady()})},e.prototype.turnOffMediator=function(){this._storeSubscription.unsubscribe(),r.prototype.turnOffMediator.call(this)},e.prototype.buildMediator=function(e){var t=c({},this.mediatorCtorOptions,{dataProvider:e}),o=new n.CollectionStore,r=new i.NgStoreListMediator(t);return r.setNgStore(o),this.listMediator=r,this.listMediator.setUp(),Promise.resolve()},Object.defineProperty(e.prototype,"asNgStoreListMeidator",{get:function(){return this.listMediator},enumerable:!0,configurable:!0}),e.prototype.readMediatorFromCache=function(e){return this.mediatorCache.get(e,this.defaultLivePeriod)},e.prototype.writeMediatorIntoCache=function(e,t){this.mediatorCache.set(e,t,this.defaultLivePeriod,function(e){return t.tearDown(),e})},e.prototype.addOnCacheExpireHandler=function(e){this._onCacheExpireCallback=function(e){return e.preventDefault(),e},this.mediatorCache.addOnExpireHandler(e,this._onCacheExpireCallback)},e.prototype.removeOnCacheExpireHandler=function(e){this.mediatorCache.rmOnExpireHandler(e,this._onCacheExpireCallback),this._onCacheExpireCallback=null},e.prototype.onNewItemsReady=function(e){return e},e}(y),v=function(t){function e(){var e=t.call(this)||this;return e.defaultLivePeriod=300,e.items=[],e._onCacheExpireCallback=null,e}return s(e,t),Object.defineProperty(e.prototype,"asWritableListMediator",{get:function(){return this.listMediator},enumerable:!0,configurable:!0}),e.prototype.useMediatorWithOnlyLocalDataProvider=function(e,t){var o={dataProvider:e,useModel:!0,enableInfinite:!0,enableRefresh:!0},r=new i.WritableListMediator(o);this.listMediator=r,this.listMediator.setUp()},e.prototype.useMediatorWithGlobalDataProvider=function(e,t,o,r){var n=new i.RxjsPoweredWritableListMediator({globalProvider:t,filterFlags:{added:!0,removed:!0,updated:!1},dataProvider:e,useModel:!0});this.listMediator=n,this.listMediator.setUp()},e.prototype.postUseFreshMediator=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.turnOnMediator.apply(this,d([!1],e)),this.afterMediatorOn()},e.prototype.postUseCachedMediator=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.turnOnMediator.apply(this,d([!0],e)),this.afterMediatorOn()},e.prototype.ensureDataProvider=function(){for(var e=this,t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];if(this.mediatorCache){var r=this.getCacheKey.apply(this,d(t)),n=this.readMediatorFromCache(r);n?(this.listMediator=n,this.postUseCachedMediator.apply(this,d(t))):this.buildMediator.apply(this,d(t)).then(function(){e.writeMediatorIntoCache(r,e.asWritableListMediator),e.postUseFreshMediator.apply(e,d([!0],t))})}else this.buildMediator.apply(this,d(t)).then(function(){e.postUseFreshMediator.apply(e,d([!1],t))})},e.prototype.afterMediatorOn=function(){if(this.mediatorCache){var e=this.getCacheKey();this.addOnCacheExpireHandler(e)}},e.prototype.afterMediatorOff=function(){if(this.mediatorCache){var e=this.getCacheKey();this.removeOnCacheExpireHandler(e)}},e.prototype.onNewItemsReady=function(e){return o.pushArray(this.items,e),e},e.prototype.onItemsReady=function(){var e=this.asWritableListMediator.viewLevelData();this.items=e.models.slice(0)},e.prototype.readMediatorFromCache=function(e){return this.mediatorCache.get(e,this.defaultLivePeriod)},e.prototype.writeMediatorIntoCache=function(e,t){this.mediatorCache.set(e,t,this.defaultLivePeriod,function(e){return t.tearDown(),e})},e.prototype.addOnCacheExpireHandler=function(e){this._onCacheExpireCallback=function(e){return e.preventDefault(),e},this.mediatorCache.addOnExpireHandler(e,this._onCacheExpireCallback)},e.prototype.removeOnCacheExpireHandler=function(e){this.mediatorCache.rmOnExpireHandler(e,this._onCacheExpireCallback),this._onCacheExpireCallback=null},e}(y),m=function M(){},b=new r.InjectionToken("Backend Settings");e.NgStoreBackedListPage=g,e.adaptAngularToController=h,e.PlatformObliviousListPage=u,e.BackboneBackedListPage=v,e.FullFeatureListPage=y,e.BackendSettings=m,e.BACKEND_SETTINGS=b,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=polpware-ngx-mvc.umd.min.js.map