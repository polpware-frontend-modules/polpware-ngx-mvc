{"version":3,"file":"polpware-ngx-mvc.js.map","sources":["ng://@polpware/ngx-mvc/lib/mvc/platform-oblivious-list-page.ts","ng://@polpware/ngx-mvc/lib/mvc/adaptors/angular-to-controller-adaptor.ts","ng://@polpware/ngx-mvc/lib/mvc/full-feature-list-page.ts","ng://@polpware/ngx-mvc/lib/mvc/ngstore-backed-list-page.ts","ng://@polpware/ngx-mvc/lib/mvc/backbone-backed-list-page.ts","ng://@polpware/ngx-mvc/lib/services/backend-settings.service.ts"],"sourcesContent":["/**\n * @fileOverview\n * This abstract class defines a base class for implementing\n * a page with such features as refreshing, loading more, and\n * listening to changes from a global database and inserting\n * or deleting elements accordingly.\n *\n * This class does not depend on any features that a specific\n * platform may provide, such as ionViewDidload and ...unload.\n *\n * @name PlatformAgosticFullFeatureListPage.ts\n * @author Xiaolong Tang <xxlongtang@gmail.com>\n * @license Copyright @me\n */\n\n// By default, we do not listen to any change ..\n\nimport * as hInterface from '@polpware/fe-dependencies';\n\nimport { IViewInstance } from '@polpware/fe-mvc';\n\nimport { IListMediatorPublic } from '@polpware/fe-mvc';\nimport { IMediatorCompatiblePage } from './mediator-compatible-page.interface';\n\nimport {\n    ILoadingIndicator,\n    IRefreshingIndicator,\n    ILoadingMoreIndicator\n} from '../interfaces/indicators.interface';\n\nconst _ = hInterface.underscore;\n\nexport abstract class PlatformObliviousListPage\n    implements IMediatorCompatiblePage,\n    ILoadingIndicator,\n    IRefreshingIndicator,\n    ILoadingMoreIndicator {\n\n    public moreDataCanBeLoaded: boolean;\n    public callbacks: {\n        onRefresh: any,\n        onInfinite: any\n    };\n\n    protected listMediator: IListMediatorPublic;\n\n    constructor() {\n        this.moreDataCanBeLoaded = false;\n        this.callbacks = {\n            onRefresh: null,\n            onInfinite: null\n        };\n    }\n\n    protected abstract buildViewInstance(): IViewInstance;\n\n    protected abstract buildMediator(...args: any[]): PromiseLike<void>;\n\n    protected turnOnMediator(fromCache: boolean, ...rest: any[]) {\n        const viewInstance = this.buildViewInstance();\n        this.listMediator.startService(viewInstance, fromCache);\n    }\n\n    protected turnOffMediator() {\n        this.listMediator.stopService();\n    }\n\n    public abstract showLoadingIndicator(...args: Array<any>): void;\n    public abstract hideLoadingIndicator(...args: Array<any>): void;\n    public abstract setLoadingIndicatorDelay(seconds: number): void;\n\n    public abstract showMoreLoading(...args: Array<any>): void;\n    public abstract hideMoreLoading(...args: Array<any>): void;\n\n    public abstract showRefreshingIndicator(...args: Array<any>): void;\n    public abstract hideRefreshingIndicator(...args: Array<any>): void;\n\n    // Will be invoked from the adaptor and therefore\n    // must be public\n    public abstract onNewItemsReady(items: Array<any>): Array<any>;\n\n    public abstract onItemsReady(): void;\n}\n\n","import * as dependencies from '@polpware/fe-dependencies';\nimport { pushArray } from '@polpware/fe-utilities';\n\nimport { IViewInstance } from '@polpware/fe-mvc';\n\nconst _ = dependencies.underscore;\nconst noop = _.noop;\n\nexport function adaptAngularToController(context): IViewInstance {\n    return {\n        $data: {\n            init: function() {\n                context.$scope.moreDataCanBeLoaded = false;\n            },\n            setRefreshCallback: function(callback) {\n                context.$scope.callbacks.onRefresh = callback;\n            },\n            setInfiniteCallback: function(callback) {\n                context.$scope.callbacks.onInfinite = callback;\n            },\n            clean: function() {\n                context.$scope.onItemsReady();\n            },\n            asyncPush: function(items) {\n                context.$scope.onNewItemsReady(items);\n                context.$scope.onItemsReady();\n            },\n            syncPush: function(items) {\n                context.$scope.onNewItemsReady(items);\n                context.$scope.onItemsReady();\n            },\n\n            asyncPop: function(items) {\n                context.$scope.onItemsReady();\n            },\n            syncPop: function(items) {\n                context.$scope.onItemsReady();\n            },\n            asyncPrepend: function(items) {\n                context.$scope.onNewItemsReady(items);\n                context.$scope.onItemsReady();\n            },\n            syncPrepend: function(items) {\n                context.$scope.onNewItemsReady(items);\n                context.$scope.onItemsReady();\n            },\n            asyncRefresh: noop,\n            syncRefresh: noop,\n            hasMoreData: function(flag) {\n                context.$scope.moreDataCanBeLoaded = flag;\n            },\n            getItems: function() {\n            },\n            setupSearch: function(criteria, callback) {\n                context.$scope.searchCriteria = criteria;\n                context.$scope.doSearch = callback;\n            },\n            updateSearchCriteria: function(criteria) {\n                context.$scope.searchCriteria = criteria;\n            },\n            getAncestor: function() {\n                return context.$scope.ancestor;\n            }\n        },\n        $loader: {\n            show: function() {\n                context.$scope.showLoadingIndicator();\n            },\n            hide: function() {\n                context.$scope.hideLoadingIndicator();\n            }\n        },\n        $refresher: {\n            show: function() {\n                context.$scope.showRefreshingIndicator();\n            },\n            hide: function() {\n                context.$scope.hideRefreshingIndicator();\n            }\n        },\n        $moreLoader: {\n            show: function() {\n                context.$scope.showMoreLoading();\n            },\n            hide: function() {\n                context.$scope.hideMoreLoading();\n            }\n        },\n        $router: {\n            go: function(url, data) {\n                context.$state.go(url, data);\n            }\n        },\n        $render: {\n            ready: function(callback) {\n                context.$scope.callbacks.onViewDidLoad = callback;\n            },\n            destroy: function(callback) {\n                context.$scope.callbacks.onViewWillUnload = callback;\n            },\n            asyncDigest: noop\n        },\n        $navBar: {\n            /**\n             * Get current state\n             * @returns {}\n             */\n            getState: noop,\n            /**\n             * Set state\n             * @param {Boolean} s\n             */\n            setState: noop\n        },\n        $modal: {\n            setData: function(key, data) {\n                context.$scope[key] = data;\n            },\n            getData: function(key) {\n                return context.$scope[key];\n            },\n            build: noop\n        },\n        $popover: {\n            setData: function(key, data) {\n                context.$scope[key] = data;\n            },\n            getData: function(key) {\n                return context.$scope[key];\n            },\n            build: noop,\n            onHidden: noop\n        },\n        $popup: {\n            setData: function(data) {\n                context.$scope.popupInput = _.extend({\n                    confirmed: false\n                }, data);\n            },\n            getData: function() {\n                return context.$scope.popupInput;\n            },\n            build: noop,\n            confirm: noop,\n            prompt: noop,\n            alert: noop\n        },\n        $progressBar: {\n            create: noop,\n            reset: function() {\n                context.$scope.progressBar = 0;\n            },\n            createInfinite: noop,\n            onProgress: function(percentage) {\n                context.$scope.progressBar = percentage;\n            },\n            destroy: noop,\n            destroyInfinite: noop,\n            showAbort: noop\n        },\n        $alertify: context.alertify,\n        $history: {\n            goBack: function() {\n                context.$ionicHistory.goBack();\n            }\n        }\n    };\n}\n\n","import { IViewInstance } from '@polpware/fe-mvc';\nimport { IListMediatorPublic } from '@polpware/fe-mvc';\n// base\nimport {\n    PlatformObliviousListPage\n} from './platform-oblivious-list-page';\n\nimport {\n    adaptAngularToController\n} from './adaptors/angular-to-controller-adaptor';\n\nexport interface IPageLifeCycle {\n    onDocumentReady(...args: Array<any>): void;\n    onDocumentDestroy(...args: Array<any>): void;\n}\n\nexport abstract class FullFeatureListPage\n    extends PlatformObliviousListPage implements IPageLifeCycle {\n\n    onDocumentReady(...args: Array<any>) {\n        // Cache will be provided in its derived class\n        this.ensureDataProvider(...args);\n    }\n\n    onDocumentDestroy(...args: Array<any>) {\n\n        // Cache will be provided in its derived class\n\n        this.turnOffMediator();\n        this.afterMediatorOff();\n    }\n\n    protected abstract ensureDataProvider(...args: Array<any>): void;\n    protected abstract afterMediatorOn(): void;\n    protected abstract afterMediatorOff(): void;\n\n    protected abstract readMediatorFromCache(key: string): IListMediatorPublic;\n    protected abstract writeMediatorIntoCache(key: string, value: IListMediatorPublic): void;\n    protected abstract addOnCacheExpireHandler(key: string): void;\n    protected abstract removeOnCacheExpireHandler(key: string): void;\n\n    // May be not needed. \n    protected onDataProviderReady(dataProvider: any): void {\n        this.buildMediator(dataProvider).then(() => {\n            this.turnOnMediator(false);\n            this.afterMediatorOn();\n        });\n    }\n\n    // Override\n    protected buildViewInstance(): IViewInstance {\n        return adaptAngularToController({\n            $scope: this\n        });\n    }\n\n    public doRefresh() {\n        // Trigger refresh\n        if (this.callbacks.onRefresh) {\n            this.callbacks.onRefresh();\n        }\n    }\n\n    public doInfinite() {\n        // Trigger loading more\n        if (this.callbacks.onInfinite) {\n            this.callbacks.onInfinite();\n        }\n    }\n\n    public showLoadingIndicator(...args: any[]) { }\n\n    public hideLoadingIndicator(...args: any[]) { }\n\n    public setLoadingIndicatorDelay(seconds: number) { }\n\n    public showMoreLoading(...args: any[]) { }\n\n    public hideMoreLoading(...args: any[]) { }\n\n    public showRefreshingIndicator(...args: any[]) { }\n\n    public hideRefreshingIndicator(...args: any[]) { }\n\n}\n\n","import { Subscription } from 'rxjs';\n\nimport {\n    IListMediatorCtorOptions\n} from '@polpware/fe-mvc';\n\nimport {\n    NgStoreListMediator,\n    INgStoreListMediatorPublic\n} from '@polpware/fe-mvc';\n\nimport {\n    ICollectionItem\n} from '@polpware/fe-data';\n\nimport {\n    CollectionStore\n} from '@polpware/fe-data';\n\n\nimport {\n    ISlidingExpireCache\n} from '@polpware/fe-data';\n\n// base\nimport { FullFeatureListPage } from './full-feature-list-page';\n\n// Note that in the class, please avoid to depend on onNewItemsReady,\n// as it is NOT in the update flow.\n\nexport abstract class NgStoreBackedListPage<T extends ICollectionItem>\n    extends FullFeatureListPage {\n\n    protected defaultLivePeriod = 60 * 5;\n\n    // More configuration for constructing dataprovider\n    protected mediatorCtorOptions: IListMediatorCtorOptions;\n\n    protected mediatorCache: ISlidingExpireCache<INgStoreListMediatorPublic>;\n    private _onCacheExpireCallback: any;\n\n    private _storeSubscription: Subscription;\n    public items: T[];\n\n    constructor() {\n        super();\n\n        this.mediatorCtorOptions = {\n            useModel: true,\n            enableInfinite: true,\n            enableRefresh: true\n        };\n        this.items = [];\n        this._onCacheExpireCallback = null;\n    }\n\n    // Override\n    protected turnOnMediator(fromCache: boolean) {\n        super.turnOnMediator(fromCache);\n\n        const store = this.asNgStoreListMeidator.getNgStore();\n        this._storeSubscription = store.getState().subscribe((data) => {\n            const w = data.items as T[];\n            this.items = w;\n            // Note that we must call onItemsReady ... \n            this.onItemsReady();\n        });\n    }\n\n    // Override\n    protected turnOffMediator() {\n        this._storeSubscription.unsubscribe();\n        super.turnOffMediator();\n    }\n\n    // Override\n    protected buildMediator(dataProvider: any): PromiseLike<void> {\n\n        const ctorOptions: IListMediatorCtorOptions = {\n            ...this.mediatorCtorOptions,\n            dataProvider: dataProvider\n        };\n\n        const s = new CollectionStore<T>();\n\n        const m: INgStoreListMediatorPublic = new NgStoreListMediator(ctorOptions);\n        m.setNgStore(s);\n\n        this.listMediator = m;\n        this.listMediator.setUp();\n\n        return Promise.resolve();\n    }\n\n    protected get asNgStoreListMeidator(): INgStoreListMediatorPublic {\n        const m = this.listMediator;\n        return m as INgStoreListMediatorPublic;\n    }\n\n    protected readMediatorFromCache(key: string): INgStoreListMediatorPublic {\n        return this.mediatorCache.get(key, this.defaultLivePeriod);\n    }\n\n    protected writeMediatorIntoCache(key: string, value: INgStoreListMediatorPublic): void {\n        this.mediatorCache.set(key, value, this.defaultLivePeriod, (evt) => {\n            value.tearDown();\n            return evt;\n        });\n    }\n\n    protected addOnCacheExpireHandler(key: string): void {\n        this._onCacheExpireCallback = function(evt) {\n            evt.preventDefault();\n            return evt;\n        };\n\n        this.mediatorCache.addOnExpireHandler(key, this._onCacheExpireCallback);\n    }\n\n    protected removeOnCacheExpireHandler(key: string): void {\n        this.mediatorCache.rmOnExpireHandler(key, this._onCacheExpireCallback);\n        this._onCacheExpireCallback = null;\n    }\n\n    // Default implementation.\n    // Override\n    // Note that in the derived class we do NOT depend on it.\n    onNewItemsReady(items: T[]) {\n        return items;\n    }\n\n}\n\n","import { Subscription } from 'rxjs';\n\nimport { IViewInstance } from '@polpware/fe-mvc';\n\nimport { pushArray } from '@polpware/fe-utilities';\n\nimport {\n    WritableListMediator,\n    IWritableListMediatorCtorOptions,\n    IWritableListMediatorPublic\n} from '@polpware/fe-mvc';\n\nimport {\n    RxjsPoweredWritableListMediator\n} from '@polpware/fe-mvc';\n\nimport {\n    ICollectionItem\n} from '@polpware/fe-data';\n\nimport {\n    ISlidingExpireCache\n} from '@polpware/fe-data';\n\n// base\nimport { FullFeatureListPage } from './full-feature-list-page';\n\n// Note that we use ICollectionItem rather than IModelLike,\n// because we assume the least requirement for the input type.\n// Precisely, the only requirement is that the collection item has an\n// id field. \n\nexport abstract class BackboneBackedListPage<T extends ICollectionItem>\n    extends FullFeatureListPage {\n\n    protected defaultLivePeriod = 60 * 5;\n\n    protected mediatorCache: ISlidingExpireCache<IWritableListMediatorPublic>;\n    private _onCacheExpireCallback: any;\n\n    public items: T[];\n\n    constructor() {\n        super();\n\n        this.items = [];\n        this._onCacheExpireCallback = null;\n    }\n\n    // We use a functon to compute cacheKey, so that we can\n    // compute the cache key with more inputs. \n    protected abstract getCacheKey(...args: any[]): string;\n\n    protected get asWritableListMediator(): IWritableListMediatorPublic {\n        const m = this.listMediator;\n        return m as IWritableListMediatorPublic;\n    }\n\n    // Default implementation for using backbone\n    protected useMediatorWithOnlyLocalDataProvider(localDataProvider: any, localOptions?: object) {\n\n        const ctorOptions: IWritableListMediatorCtorOptions = {\n            dataProvider: localDataProvider,\n            useModel: true,\n            enableInfinite: true,\n            enableRefresh: true\n        };\n\n        const s = new WritableListMediator(ctorOptions);\n        this.listMediator = s;\n        this.listMediator.setUp();\n    }\n\n    protected useMediatorWithGlobalDataProvider(localDataProvider: any, globalDataProvider: any,\n        localOptions?: object, globalOptions?: object) {\n\n        const mediator = new RxjsPoweredWritableListMediator({\n            globalProvider: globalDataProvider,\n            filterFlags: {\n                added: true,\n                removed: true,\n                updated: false\n            },\n            dataProvider: localDataProvider,\n            useModel: true\n        });\n\n        this.listMediator = mediator;\n        this.listMediator.setUp();\n    }\n\n    // Invoked after the new mediator is constructure \n    protected postUseFreshMediator(...args: any[]) {\n        this.turnOnMediator(false, ...args);\n        this.afterMediatorOn();\n    }\n\n    // Invoked after the cached mediator is used \n    protected postUseCachedMediator(...args: any[]) {\n        this.turnOnMediator(true, ...args);\n        this.afterMediatorOn();\n    }\n\n    // Override to support cache\n    protected ensureDataProvider(...args: any[]) {\n        if (this.mediatorCache) {\n\n            const cacheKey = this.getCacheKey(...args);\n            let inCache = false;\n\n            const mediator = this.readMediatorFromCache(cacheKey);\n\n            if (!mediator) { // Not in cache\n\n                this.buildMediator(...args).then(() => {\n                    // set up in the cache\n                    this.writeMediatorIntoCache(cacheKey, this.asWritableListMediator);\n\n                    // case 1:\n                    this.postUseFreshMediator(true, ...args);\n                });\n\n            } else { // In cache\n\n                inCache = true;\n                this.listMediator = mediator;\n\n                // Case 2:\n                this.postUseCachedMediator(...args);\n            }\n\n        } else {\n\n            this.buildMediator(...args).then(() => {\n\n                // Case 3: \n                this.postUseFreshMediator(false, ...args);\n            });\n        }\n    }\n\n    // Override\n    protected afterMediatorOn() {\n        if (this.mediatorCache) {\n            // In this case, we do not Provide any inputs \n            const cacheKey = this.getCacheKey();\n            this.addOnCacheExpireHandler(cacheKey);\n        }\n    }\n\n    // Override\n    protected afterMediatorOff() {\n        if (this.mediatorCache) {\n            // In this case, we do not Provide any inputs\n            const cacheKey = this.getCacheKey();\n            this.removeOnCacheExpireHandler(cacheKey);\n        }\n    }\n\n\n    // Default implementation\n    public onNewItemsReady(items: Array<any>): Array<any> {\n        pushArray(this.items, items);\n        return items;\n    }\n\n    // Default implementation.\n    onItemsReady() {\n        const viewData = this.asWritableListMediator.viewLevelData();\n        // Get the data from the view level data \n        this.items = viewData.models.slice(0);\n    }\n\n    // Note that it is up to the caller to decide how to use the\n    // cached value; we need to precisely tell where there is a value in the cache\n    // for the corresponding key\n    protected readMediatorFromCache(key: string): IWritableListMediatorPublic {\n        return this.mediatorCache.get(key, this.defaultLivePeriod);\n    }\n\n    protected writeMediatorIntoCache(key: string, mediator: IWritableListMediatorPublic): void {\n        this.mediatorCache.set(key, mediator, this.defaultLivePeriod, (evt) => {\n            mediator.tearDown();\n            return evt;\n        });\n    }\n\n    protected addOnCacheExpireHandler(key: string): void {\n        this._onCacheExpireCallback = function(evt) {\n            evt.preventDefault();\n            return evt;\n        };\n\n        this.mediatorCache.addOnExpireHandler(key, this._onCacheExpireCallback);\n    }\n\n    protected removeOnCacheExpireHandler(key: string): void {\n        this.mediatorCache.rmOnExpireHandler(key, this._onCacheExpireCallback);\n        this._onCacheExpireCallback = null;\n    }\n\n}\n\n","import { InjectionToken } from '@angular/core';\n\nexport class BackendSettings {\n    urlBase: string;\n}\n\nexport const BACKEND_SETTINGS = new InjectionToken<BackendSettings>('Backend Settings');\n"],"names":["_","dependencies.underscore","tslib_1.__extends"],"mappings":";;;;;;;;;;;;;;;;;;;AAgCA;;;;IAcI;QACI,IAAI,CAAC,mBAAmB,GAAG,KAAK,CAAC;QACjC,IAAI,CAAC,SAAS,GAAG;YACb,SAAS,EAAE,IAAI;YACf,UAAU,EAAE,IAAI;SACnB,CAAC;KACL;;;;;;;IAMS,kDAAc;;;;;;IAAxB,UAAyB,SAAkB;QAAE,cAAc;aAAd,UAAc,EAAd,qBAAc,EAAd,IAAc;YAAd,6BAAc;;;YACjD,YAAY,GAAG,IAAI,CAAC,iBAAiB,EAAE;QAC7C,IAAI,CAAC,YAAY,CAAC,YAAY,CAAC,YAAY,EAAE,SAAS,CAAC,CAAC;KAC3D;;;;;IAES,mDAAe;;;;IAAzB;QACI,IAAI,CAAC,YAAY,CAAC,WAAW,EAAE,CAAC;KACnC;IAiBL,gCAAC;CAAA;;;;;;AClFD;IAKMA,GAAC,GAAGC,UAAuB;;IAC3B,IAAI,GAAGD,GAAC,CAAC,IAAI;;;;;AAEnB,SAAgB,wBAAwB,CAAC,OAAO;IAC5C,OAAO;QACH,KAAK,EAAE;YACH,IAAI,EAAE;gBACF,OAAO,CAAC,MAAM,CAAC,mBAAmB,GAAG,KAAK,CAAC;aAC9C;YACD,kBAAkB,EAAE,UAAS,QAAQ;gBACjC,OAAO,CAAC,MAAM,CAAC,SAAS,CAAC,SAAS,GAAG,QAAQ,CAAC;aACjD;YACD,mBAAmB,EAAE,UAAS,QAAQ;gBAClC,OAAO,CAAC,MAAM,CAAC,SAAS,CAAC,UAAU,GAAG,QAAQ,CAAC;aAClD;YACD,KAAK,EAAE;gBACH,OAAO,CAAC,MAAM,CAAC,YAAY,EAAE,CAAC;aACjC;YACD,SAAS,EAAE,UAAS,KAAK;gBACrB,OAAO,CAAC,MAAM,CAAC,eAAe,CAAC,KAAK,CAAC,CAAC;gBACtC,OAAO,CAAC,MAAM,CAAC,YAAY,EAAE,CAAC;aACjC;YACD,QAAQ,EAAE,UAAS,KAAK;gBACpB,OAAO,CAAC,MAAM,CAAC,eAAe,CAAC,KAAK,CAAC,CAAC;gBACtC,OAAO,CAAC,MAAM,CAAC,YAAY,EAAE,CAAC;aACjC;YAED,QAAQ,EAAE,UAAS,KAAK;gBACpB,OAAO,CAAC,MAAM,CAAC,YAAY,EAAE,CAAC;aACjC;YACD,OAAO,EAAE,UAAS,KAAK;gBACnB,OAAO,CAAC,MAAM,CAAC,YAAY,EAAE,CAAC;aACjC;YACD,YAAY,EAAE,UAAS,KAAK;gBACxB,OAAO,CAAC,MAAM,CAAC,eAAe,CAAC,KAAK,CAAC,CAAC;gBACtC,OAAO,CAAC,MAAM,CAAC,YAAY,EAAE,CAAC;aACjC;YACD,WAAW,EAAE,UAAS,KAAK;gBACvB,OAAO,CAAC,MAAM,CAAC,eAAe,CAAC,KAAK,CAAC,CAAC;gBACtC,OAAO,CAAC,MAAM,CAAC,YAAY,EAAE,CAAC;aACjC;YACD,YAAY,EAAE,IAAI;YAClB,WAAW,EAAE,IAAI;YACjB,WAAW,EAAE,UAAS,IAAI;gBACtB,OAAO,CAAC,MAAM,CAAC,mBAAmB,GAAG,IAAI,CAAC;aAC7C;YACD,QAAQ,EAAE;aACT;YACD,WAAW,EAAE,UAAS,QAAQ,EAAE,QAAQ;gBACpC,OAAO,CAAC,MAAM,CAAC,cAAc,GAAG,QAAQ,CAAC;gBACzC,OAAO,CAAC,MAAM,CAAC,QAAQ,GAAG,QAAQ,CAAC;aACtC;YACD,oBAAoB,EAAE,UAAS,QAAQ;gBACnC,OAAO,CAAC,MAAM,CAAC,cAAc,GAAG,QAAQ,CAAC;aAC5C;YACD,WAAW,EAAE;gBACT,OAAO,OAAO,CAAC,MAAM,CAAC,QAAQ,CAAC;aAClC;SACJ;QACD,OAAO,EAAE;YACL,IAAI,EAAE;gBACF,OAAO,CAAC,MAAM,CAAC,oBAAoB,EAAE,CAAC;aACzC;YACD,IAAI,EAAE;gBACF,OAAO,CAAC,MAAM,CAAC,oBAAoB,EAAE,CAAC;aACzC;SACJ;QACD,UAAU,EAAE;YACR,IAAI,EAAE;gBACF,OAAO,CAAC,MAAM,CAAC,uBAAuB,EAAE,CAAC;aAC5C;YACD,IAAI,EAAE;gBACF,OAAO,CAAC,MAAM,CAAC,uBAAuB,EAAE,CAAC;aAC5C;SACJ;QACD,WAAW,EAAE;YACT,IAAI,EAAE;gBACF,OAAO,CAAC,MAAM,CAAC,eAAe,EAAE,CAAC;aACpC;YACD,IAAI,EAAE;gBACF,OAAO,CAAC,MAAM,CAAC,eAAe,EAAE,CAAC;aACpC;SACJ;QACD,OAAO,EAAE;YACL,EAAE,EAAE,UAAS,GAAG,EAAE,IAAI;gBAClB,OAAO,CAAC,MAAM,CAAC,EAAE,CAAC,GAAG,EAAE,IAAI,CAAC,CAAC;aAChC;SACJ;QACD,OAAO,EAAE;YACL,KAAK,EAAE,UAAS,QAAQ;gBACpB,OAAO,CAAC,MAAM,CAAC,SAAS,CAAC,aAAa,GAAG,QAAQ,CAAC;aACrD;YACD,OAAO,EAAE,UAAS,QAAQ;gBACtB,OAAO,CAAC,MAAM,CAAC,SAAS,CAAC,gBAAgB,GAAG,QAAQ,CAAC;aACxD;YACD,WAAW,EAAE,IAAI;SACpB;QACD,OAAO,EAAE;;;;YAKL,QAAQ,EAAE,IAAI;;;;YAKd,QAAQ,EAAE,IAAI;SACjB;QACD,MAAM,EAAE;YACJ,OAAO,EAAE,UAAS,GAAG,EAAE,IAAI;gBACvB,OAAO,CAAC,MAAM,CAAC,GAAG,CAAC,GAAG,IAAI,CAAC;aAC9B;YACD,OAAO,EAAE,UAAS,GAAG;gBACjB,OAAO,OAAO,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC;aAC9B;YACD,KAAK,EAAE,IAAI;SACd;QACD,QAAQ,EAAE;YACN,OAAO,EAAE,UAAS,GAAG,EAAE,IAAI;gBACvB,OAAO,CAAC,MAAM,CAAC,GAAG,CAAC,GAAG,IAAI,CAAC;aAC9B;YACD,OAAO,EAAE,UAAS,GAAG;gBACjB,OAAO,OAAO,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC;aAC9B;YACD,KAAK,EAAE,IAAI;YACX,QAAQ,EAAE,IAAI;SACjB;QACD,MAAM,EAAE;YACJ,OAAO,EAAE,UAAS,IAAI;gBAClB,OAAO,CAAC,MAAM,CAAC,UAAU,GAAGA,GAAC,CAAC,MAAM,CAAC;oBACjC,SAAS,EAAE,KAAK;iBACnB,EAAE,IAAI,CAAC,CAAC;aACZ;YACD,OAAO,EAAE;gBACL,OAAO,OAAO,CAAC,MAAM,CAAC,UAAU,CAAC;aACpC;YACD,KAAK,EAAE,IAAI;YACX,OAAO,EAAE,IAAI;YACb,MAAM,EAAE,IAAI;YACZ,KAAK,EAAE,IAAI;SACd;QACD,YAAY,EAAE;YACV,MAAM,EAAE,IAAI;YACZ,KAAK,EAAE;gBACH,OAAO,CAAC,MAAM,CAAC,WAAW,GAAG,CAAC,CAAC;aAClC;YACD,cAAc,EAAE,IAAI;YACpB,UAAU,EAAE,UAAS,UAAU;gBAC3B,OAAO,CAAC,MAAM,CAAC,WAAW,GAAG,UAAU,CAAC;aAC3C;YACD,OAAO,EAAE,IAAI;YACb,eAAe,EAAE,IAAI;YACrB,SAAS,EAAE,IAAI;SAClB;QACD,SAAS,EAAE,OAAO,CAAC,QAAQ;QAC3B,QAAQ,EAAE;YACN,MAAM,EAAE;gBACJ,OAAO,CAAC,aAAa,CAAC,MAAM,EAAE,CAAC;aAClC;SACJ;KACJ,CAAC;CACL;;;;;;;;;ACvJD;;;;IACYE,uCAAyB;IADrC;;KAoEC;;;;;IAjEG,6CAAe;;;;IAAf;QAAgB,cAAmB;aAAnB,UAAmB,EAAnB,qBAAmB,EAAnB,IAAmB;YAAnB,yBAAmB;;;QAE/B,IAAI,CAAC,kBAAkB,OAAvB,IAAI,WAAuB,IAAI,GAAE;KACpC;;;;;IAED,+CAAiB;;;;IAAjB;;QAAkB,cAAmB;aAAnB,UAAmB,EAAnB,qBAAmB,EAAnB,IAAmB;YAAnB,yBAAmB;;QAIjC,IAAI,CAAC,eAAe,EAAE,CAAC;QACvB,IAAI,CAAC,gBAAgB,EAAE,CAAC;KAC3B;;;;;;;;IAYS,iDAAmB;;;;;;;IAA7B,UAA8B,YAAiB;QAA/C,iBAKC;QAJG,IAAI,CAAC,aAAa,CAAC,YAAY,CAAC,CAAC,IAAI,CAAC;YAClC,KAAI,CAAC,cAAc,CAAC,KAAK,CAAC,CAAC;YAC3B,KAAI,CAAC,eAAe,EAAE,CAAC;SAC1B,CAAC,CAAC;KACN;;;;;;;IAGS,+CAAiB;;;;;;IAA3B;QACI,OAAO,wBAAwB,CAAC;YAC5B,MAAM,EAAE,IAAI;SACf,CAAC,CAAC;KACN;;;;IAEM,uCAAS;;;IAAhB;;QAEI,IAAI,IAAI,CAAC,SAAS,CAAC,SAAS,EAAE;YAC1B,IAAI,CAAC,SAAS,CAAC,SAAS,EAAE,CAAC;SAC9B;KACJ;;;;IAEM,wCAAU;;;IAAjB;;QAEI,IAAI,IAAI,CAAC,SAAS,CAAC,UAAU,EAAE;YAC3B,IAAI,CAAC,SAAS,CAAC,UAAU,EAAE,CAAC;SAC/B;KACJ;;;;;IAEM,kDAAoB;;;;IAA3B;QAA4B,cAAc;aAAd,UAAc,EAAd,qBAAc,EAAd,IAAc;YAAd,yBAAc;;KAAK;;;;;IAExC,kDAAoB;;;;IAA3B;QAA4B,cAAc;aAAd,UAAc,EAAd,qBAAc,EAAd,IAAc;YAAd,yBAAc;;KAAK;;;;;IAExC,sDAAwB;;;;IAA/B,UAAgC,OAAe,KAAK;;;;;IAE7C,6CAAe;;;;IAAtB;QAAuB,cAAc;aAAd,UAAc,EAAd,qBAAc,EAAd,IAAc;YAAd,yBAAc;;KAAK;;;;;IAEnC,6CAAe;;;;IAAtB;QAAuB,cAAc;aAAd,UAAc,EAAd,qBAAc,EAAd,IAAc;YAAd,yBAAc;;KAAK;;;;;IAEnC,qDAAuB;;;;IAA9B;QAA+B,cAAc;aAAd,UAAc,EAAd,qBAAc,EAAd,IAAc;YAAd,yBAAc;;KAAK;;;;;IAE3C,qDAAuB;;;;IAA9B;QAA+B,cAAc;aAAd,UAAc,EAAd,qBAAc,EAAd,IAAc;YAAd,yBAAc;;KAAK;IAEtD,0BAAC;CApED,CACY,yBAAyB;;;;;;;;;;;;ACarC;;;;;;;;IACYA,yCAAmB;IAa3B;QAAA,YACI,iBAAO,SASV;QArBS,uBAAiB,GAAG,EAAE,GAAG,CAAC,CAAC;QAcjC,KAAI,CAAC,mBAAmB,GAAG;YACvB,QAAQ,EAAE,IAAI;YACd,cAAc,EAAE,IAAI;YACpB,aAAa,EAAE,IAAI;SACtB,CAAC;QACF,KAAI,CAAC,KAAK,GAAG,EAAE,CAAC;QAChB,KAAI,CAAC,sBAAsB,GAAG,IAAI,CAAC;;KACtC;;;;;;;;IAGS,8CAAc;;;;;;;IAAxB,UAAyB,SAAkB;QAA3C,iBAUC;QATG,iBAAM,cAAc,YAAC,SAAS,CAAC,CAAC;;YAE1B,KAAK,GAAG,IAAI,CAAC,qBAAqB,CAAC,UAAU,EAAE;QACrD,IAAI,CAAC,kBAAkB,GAAG,KAAK,CAAC,QAAQ,EAAE,CAAC,SAAS,CAAC,UAAC,IAAI;;gBAChD,CAAC,sBAAG,IAAI,CAAC,KAAK,EAAO;YAC3B,KAAI,CAAC,KAAK,GAAG,CAAC,CAAC;;YAEf,KAAI,CAAC,YAAY,EAAE,CAAC;SACvB,CAAC,CAAC;KACN;;;;;;;IAGS,+CAAe;;;;;;IAAzB;QACI,IAAI,CAAC,kBAAkB,CAAC,WAAW,EAAE,CAAC;QACtC,iBAAM,eAAe,WAAE,CAAC;KAC3B;;;;;;;;IAGS,6CAAa;;;;;;;IAAvB,UAAwB,YAAiB;;YAE/B,WAAW,gBACV,IAAI,CAAC,mBAAmB,IAC3B,YAAY,EAAE,YAAY,GAC7B;;YAEK,CAAC,GAAG,IAAI,eAAe,EAAK;;YAE5B,CAAC,GAA+B,IAAI,mBAAmB,CAAC,WAAW,CAAC;QAC1E,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC;QAEhB,IAAI,CAAC,YAAY,GAAG,CAAC,CAAC;QACtB,IAAI,CAAC,YAAY,CAAC,KAAK,EAAE,CAAC;QAE1B,OAAO,OAAO,CAAC,OAAO,EAAE,CAAC;KAC5B;IAED,sBAAc,wDAAqB;;;;;QAAnC;;gBACU,CAAC,GAAG,IAAI,CAAC,YAAY;YAC3B,0BAAO,CAAC,GAA+B;SAC1C;;;OAAA;;;;;;IAES,qDAAqB;;;;;IAA/B,UAAgC,GAAW;QACvC,OAAO,IAAI,CAAC,aAAa,CAAC,GAAG,CAAC,GAAG,EAAE,IAAI,CAAC,iBAAiB,CAAC,CAAC;KAC9D;;;;;;;IAES,sDAAsB;;;;;;IAAhC,UAAiC,GAAW,EAAE,KAAiC;QAC3E,IAAI,CAAC,aAAa,CAAC,GAAG,CAAC,GAAG,EAAE,KAAK,EAAE,IAAI,CAAC,iBAAiB,EAAE,UAAC,GAAG;YAC3D,KAAK,CAAC,QAAQ,EAAE,CAAC;YACjB,OAAO,GAAG,CAAC;SACd,CAAC,CAAC;KACN;;;;;;IAES,uDAAuB;;;;;IAAjC,UAAkC,GAAW;QACzC,IAAI,CAAC,sBAAsB,GAAG,UAAS,GAAG;YACtC,GAAG,CAAC,cAAc,EAAE,CAAC;YACrB,OAAO,GAAG,CAAC;SACd,CAAC;QAEF,IAAI,CAAC,aAAa,CAAC,kBAAkB,CAAC,GAAG,EAAE,IAAI,CAAC,sBAAsB,CAAC,CAAC;KAC3E;;;;;;IAES,0DAA0B;;;;;IAApC,UAAqC,GAAW;QAC5C,IAAI,CAAC,aAAa,CAAC,iBAAiB,CAAC,GAAG,EAAE,IAAI,CAAC,sBAAsB,CAAC,CAAC;QACvE,IAAI,CAAC,sBAAsB,GAAG,IAAI,CAAC;KACtC;;;;;;;;;;;IAKD,+CAAe;;;;;;;;IAAf,UAAgB,KAAU;QACtB,OAAO,KAAK,CAAC;KAChB;IAEL,4BAAC;CArGD,CACY,mBAAmB;;;;;;;;;;;;;;ACC/B;;;;;;;;;;IACYA,0CAAmB;IAS3B;QAAA,YACI,iBAAO,SAIV;QAZS,uBAAiB,GAAG,EAAE,GAAG,CAAC,CAAC;QAUjC,KAAI,CAAC,KAAK,GAAG,EAAE,CAAC;QAChB,KAAI,CAAC,sBAAsB,GAAG,IAAI,CAAC;;KACtC;IAMD,sBAAc,0DAAsB;;;;;QAApC;;gBACU,CAAC,GAAG,IAAI,CAAC,YAAY;YAC3B,0BAAO,CAAC,GAAgC;SAC3C;;;OAAA;;;;;;;;;IAGS,qEAAoC;;;;;;;;IAA9C,UAA+C,iBAAsB,EAAE,YAAqB;;YAElF,WAAW,GAAqC;YAClD,YAAY,EAAE,iBAAiB;YAC/B,QAAQ,EAAE,IAAI;YACd,cAAc,EAAE,IAAI;YACpB,aAAa,EAAE,IAAI;SACtB;;YAEK,CAAC,GAAG,IAAI,oBAAoB,CAAC,WAAW,CAAC;QAC/C,IAAI,CAAC,YAAY,GAAG,CAAC,CAAC;QACtB,IAAI,CAAC,YAAY,CAAC,KAAK,EAAE,CAAC;KAC7B;;;;;;;;;IAES,kEAAiC;;;;;;;;IAA3C,UAA4C,iBAAsB,EAAE,kBAAuB,EACvF,YAAqB,EAAE,aAAsB;;YAEvC,QAAQ,GAAG,IAAI,+BAA+B,CAAC;YACjD,cAAc,EAAE,kBAAkB;YAClC,WAAW,EAAE;gBACT,KAAK,EAAE,IAAI;gBACX,OAAO,EAAE,IAAI;gBACb,OAAO,EAAE,KAAK;aACjB;YACD,YAAY,EAAE,iBAAiB;YAC/B,QAAQ,EAAE,IAAI;SACjB,CAAC;QAEF,IAAI,CAAC,YAAY,GAAG,QAAQ,CAAC;QAC7B,IAAI,CAAC,YAAY,CAAC,KAAK,EAAE,CAAC;KAC7B;;;;;;;;IAGS,qDAAoB;;;;;;;IAA9B;QAA+B,cAAc;aAAd,UAAc,EAAd,qBAAc,EAAd,IAAc;YAAd,yBAAc;;QACzC,IAAI,CAAC,cAAc,OAAnB,IAAI,YAAgB,KAAK,GAAK,IAAI,GAAE;QACpC,IAAI,CAAC,eAAe,EAAE,CAAC;KAC1B;;;;;;;;IAGS,sDAAqB;;;;;;;IAA/B;QAAgC,cAAc;aAAd,UAAc,EAAd,qBAAc,EAAd,IAAc;YAAd,yBAAc;;QAC1C,IAAI,CAAC,cAAc,OAAnB,IAAI,YAAgB,IAAI,GAAK,IAAI,GAAE;QACnC,IAAI,CAAC,eAAe,EAAE,CAAC;KAC1B;;;;;;;;IAGS,mDAAkB;;;;;;;IAA5B;QAAA,iBAmCC;QAnC4B,cAAc;aAAd,UAAc,EAAd,qBAAc,EAAd,IAAc;YAAd,yBAAc;;QACvC,IAAI,IAAI,CAAC,aAAa,EAAE;;gBAEd,UAAQ,GAAG,IAAI,CAAC,WAAW,OAAhB,IAAI,WAAgB,IAAI,EAAC;;gBAGpC,QAAQ,GAAG,IAAI,CAAC,qBAAqB,CAAC,UAAQ,CAAC;YAErD,IAAI,CAAC,QAAQ,EAAE;gBAEX,IAAI,CAAC,aAAa;gBAAlB,IAAI,WAAkB,IAAI,GAAE,IAAI,CAAC;;oBAE7B,KAAI,CAAC,sBAAsB,CAAC,UAAQ,EAAE,KAAI,CAAC,sBAAsB,CAAC,CAAC;;oBAGnE,KAAI,CAAC,oBAAoB,OAAzB,KAAI,YAAsB,IAAI,GAAK,IAAI,GAAE;iBAC5C,CAAC,CAAC;aAEN;iBAAM;gBAGH,IAAI,CAAC,YAAY,GAAG,QAAQ,CAAC;;gBAG7B,IAAI,CAAC,qBAAqB,OAA1B,IAAI,WAA0B,IAAI,GAAE;aACvC;SAEJ;aAAM;YAEH,IAAI,CAAC,aAAa,OAAlB,IAAI,WAAkB,IAAI,GAAE,IAAI,CAAC;;gBAG7B,KAAI,CAAC,oBAAoB,OAAzB,KAAI,YAAsB,KAAK,GAAK,IAAI,GAAE;aAC7C,CAAC,CAAC;SACN;KACJ;;;;;;;IAGS,gDAAe;;;;;;IAAzB;QACI,IAAI,IAAI,CAAC,aAAa,EAAE;;;gBAEd,QAAQ,GAAG,IAAI,CAAC,WAAW,EAAE;YACnC,IAAI,CAAC,uBAAuB,CAAC,QAAQ,CAAC,CAAC;SAC1C;KACJ;;;;;;;IAGS,iDAAgB;;;;;;IAA1B;QACI,IAAI,IAAI,CAAC,aAAa,EAAE;;;gBAEd,QAAQ,GAAG,IAAI,CAAC,WAAW,EAAE;YACnC,IAAI,CAAC,0BAA0B,CAAC,QAAQ,CAAC,CAAC;SAC7C;KACJ;;;;;;;IAIM,gDAAe;;;;;;IAAtB,UAAuB,KAAiB;QACpC,SAAS,CAAC,IAAI,CAAC,KAAK,EAAE,KAAK,CAAC,CAAC;QAC7B,OAAO,KAAK,CAAC;KAChB;;;;;;IAGD,6CAAY;;;;;IAAZ;;YACU,QAAQ,GAAG,IAAI,CAAC,sBAAsB,CAAC,aAAa,EAAE;;QAE5D,IAAI,CAAC,KAAK,GAAG,QAAQ,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;KACzC;;;;;;;;;;;;IAKS,sDAAqB;;;;;;;;;IAA/B,UAAgC,GAAW;QACvC,OAAO,IAAI,CAAC,aAAa,CAAC,GAAG,CAAC,GAAG,EAAE,IAAI,CAAC,iBAAiB,CAAC,CAAC;KAC9D;;;;;;;IAES,uDAAsB;;;;;;IAAhC,UAAiC,GAAW,EAAE,QAAqC;QAC/E,IAAI,CAAC,aAAa,CAAC,GAAG,CAAC,GAAG,EAAE,QAAQ,EAAE,IAAI,CAAC,iBAAiB,EAAE,UAAC,GAAG;YAC9D,QAAQ,CAAC,QAAQ,EAAE,CAAC;YACpB,OAAO,GAAG,CAAC;SACd,CAAC,CAAC;KACN;;;;;;IAES,wDAAuB;;;;;IAAjC,UAAkC,GAAW;QACzC,IAAI,CAAC,sBAAsB,GAAG,UAAS,GAAG;YACtC,GAAG,CAAC,cAAc,EAAE,CAAC;YACrB,OAAO,GAAG,CAAC;SACd,CAAC;QAEF,IAAI,CAAC,aAAa,CAAC,kBAAkB,CAAC,GAAG,EAAE,IAAI,CAAC,sBAAsB,CAAC,CAAC;KAC3E;;;;;;IAES,2DAA0B;;;;;IAApC,UAAqC,GAAW;QAC5C,IAAI,CAAC,aAAa,CAAC,iBAAiB,CAAC,GAAG,EAAE,IAAI,CAAC,sBAAsB,CAAC,CAAC;QACvE,IAAI,CAAC,sBAAsB,GAAG,IAAI,CAAC;KACtC;IAEL,6BAAC;CAzKD,CACY,mBAAmB;;;;;;;;;;;ACjC/B;IAEA;KAEC;IAAD,sBAAC;CAAA,IAAA;;AAED,IAAa,gBAAgB,GAAG,IAAI,cAAc,CAAkB,kBAAkB,CAAC;;;;;;;;;;;;;;"}
